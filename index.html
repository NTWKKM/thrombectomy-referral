<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß Stroke FAST TRACK - Mechanical Thrombectomy</title>
    <style>
        /* Design System Variables */
        :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  /* RGB versions for opacity control */
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  /* Background color tokens (Light Mode) */
  --color-bg-1: rgba(59, 130, 246, 0.08);
  --color-bg-2: rgba(245, 158, 11, 0.08);
  --color-bg-3: rgba(34, 197, 94, 0.08);
  --color-bg-4: rgba(239, 68, 68, 0.08);
  --color-bg-5: rgba(147, 51, 234, 0.08);
  --color-bg-6: rgba(249, 115, 22, 0.08);
  --color-bg-7: rgba(236, 72, 153, 0.08);
  --color-bg-8: rgba(6, 182, 212, 0.08);

  /* Semantic Color Tokens (Light Mode) */
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);
  --select-caret-light: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23134252' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");

  /* Typography */
  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-normal: 1.5;
  --line-height-tight: 1.2;

  /* Spacing */
  --space-4: 4px;
  --space-6: 6px;
  --space-8: 8px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  /* Border Radius */
  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;

  /* Shadows */
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);

  /* Animation */
  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
}

@media (prefers-color-scheme: dark) {
  :root {
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;

    --color-bg-1: rgba(29, 78, 216, 0.15);
    --color-bg-2: rgba(180, 83, 9, 0.15);
    --color-bg-3: rgba(21, 128, 61, 0.15);
    --color-bg-4: rgba(185, 28, 28, 0.15);
    --color-bg-5: rgba(107, 33, 168, 0.15);
    --color-bg-6: rgba(194, 65, 12, 0.15);
    --color-bg-7: rgba(190, 24, 93, 0.15);
    --color-bg-8: rgba(8, 145, 178, 0.15);

    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
  }
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2') format('woff2');
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: var(--font-family-base);
    font-size: var(--font-size-base);
    line-height: var(--line-height-normal);
    color: var(--color-text);
    background-color: var(--color-background);
    -webkit-font-smoothing: antialiased;
}

.app-container {
    max-width: 900px;
    margin: 0 auto;
    padding: var(--space-24);
}

.app-header {
    text-align: center;
    margin-bottom: var(--space-32);
    padding: var(--space-24);
    background: var(--color-bg-1);
    border-radius: var(--radius-lg);
    border: 1px solid var(--color-card-border);
}

.app-header h1 {
    font-size: var(--font-size-3xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text);
    margin-bottom: var(--space-8);
}

.app-header p {
    font-size: var(--font-size-base);
    color: var(--color-text-secondary);
}

.section {
    background: var(--color-surface);
    border: 1px solid var(--color-card-border);
    border-radius: var(--radius-lg);
    margin-bottom: var(--space-16);
    overflow: hidden;
}

.section-header {
    padding: var(--space-16);
    background: var(--color-bg-2);
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    user-select: none;
}

.section-header:hover {
    background: var(--color-bg-3);
}

.section-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
}

.section-icon {
    transition: transform var(--duration-fast) var(--ease-standard);
}

.section-icon.collapsed {
    transform: rotate(-90deg);
}

.section-content {
    padding: var(--space-20);
    display: none;
}

.section-content.expanded {
    display: block;
}

.form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-16);
    margin-bottom: var(--space-16);
}

.form-group {
    display: flex;
    flex-direction: column;
}

.form-label {
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
    margin-bottom: var(--space-6);
}

.form-input,
.form-select,
.form-textarea {
    padding: var(--space-8) var(--space-12);
    font-size: var(--font-size-base);
    font-family: var(--font-family-base);
    color: var(--color-text);
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-base);
    transition: border-color var(--duration-fast) var(--ease-standard);
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: var(--focus-ring);
}

.form-select {
    appearance: none;
    background-image: var(--select-caret-light);
    background-repeat: no-repeat;
    background-position: right var(--space-12) center;
    background-size: 16px;
    padding-right: var(--space-32);
}

.form-textarea {
    min-height: 80px;
    resize: vertical;
}

.radio-group,
.checkbox-group {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-16);
}

.radio-item,
.checkbox-item {
    display: flex;
    align-items: center;
    gap: var(--space-6);
}

.radio-item input,
.checkbox-item input {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.radio-item label,
.checkbox-item label {
    font-size: var(--font-size-base);
    color: var(--color-text);
    cursor: pointer;
}

.rtpa-calculation {
    background: var(--color-bg-3);
    padding: var(--space-16);
    border-radius: var(--radius-base);
    margin-top: var(--space-16);
    border: 1px solid var(--color-success);
}

.rtpa-calculation h4 {
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text);
    margin-bottom: var(--space-12);
}

.rtpa-dose-item {
    display: flex;
    justify-content: space-between;
    padding: var(--space-6) 0;
    border-bottom: 1px solid var(--color-card-border-inner);
}

.rtpa-dose-item:last-child {
    border-bottom: none;
}

.action-buttons {
    display: flex;
    gap: var(--space-12);
    justify-content: center;
    margin-top: var(--space-32);
    flex-wrap: wrap;
}

.btn {
    padding: var(--space-12) var(--space-24);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    font-family: var(--font-family-base);
    border: none;
    border-radius: var(--radius-base);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-standard);
}

.btn-primary {
    background: var(--color-primary);
    color: var(--color-btn-primary-text);
}

.btn-primary:hover {
    background: var(--color-primary-hover);
}

.btn-secondary {
    background: var(--color-secondary);
    color: var(--color-text);
}

.btn-secondary:hover {
    background: var(--color-secondary-hover);
}

.btn-outline {
    background: transparent;
    border: 1px solid var(--color-border);
    color: var(--color-text);
}

.btn-outline:hover {
    background: var(--color-secondary);
}

/* Print Styles */
.print-preview {
    display: none;
    background: white;
    color: black;
    padding: 40px;
    max-width: 210mm;
    margin: 0 auto;
}

.print-preview.active {
    display: block;
}

.print-header {
    text-align: center;
    border-bottom: 3px solid #333;
    padding-bottom: 20px;
    margin-bottom: 30px;
}

.print-header h1 {
    font-size: 24px;
    font-weight: bold;
    color: #000;
    margin-bottom: 10px;
}

.print-header .subtitle {
    font-size: 16px;
    color: #555;
}

.print-section {
    margin-bottom: 25px;
    page-break-inside: avoid;
}

.print-section-title {
    font-size: 16px;
    font-weight: bold;
    background: #f0f0f0;
    padding: 8px 12px;
    border-left: 4px solid #20808d;
    margin-bottom: 12px;
}

.print-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-bottom: 12px;
}

.print-item {
    display: flex;
    padding: 6px 0;
}

.print-item-label {
    font-weight: 600;
    min-width: 140px;
    color: #333;
}

.print-item-value {
    color: #000;
}

.print-full-width {
    grid-column: 1 / -1;
}

.print-signature-area {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 40px;
    margin-top: 40px;
    page-break-inside: avoid;
}

.signature-box {
    text-align: center;
}

.signature-line {
    border-top: 1px solid #333;
    margin-top: 60px;
    padding-top: 8px;
}

.print-footer {
    margin-top: 30px;
    padding-top: 20px;
    border-top: 2px solid #ddd;
    text-align: center;
    color: #777;
    font-size: 12px;
}

@media print {
    body {
        background: white;
    }
    
    .app-container,
    .action-buttons {
        display: none !important;
    }
    
    .print-preview {
        display: block !important;
        padding: 0;
        max-width: 100%;
    }
}

@media (max-width: 768px) {
    .app-container {
        padding: var(--space-16);
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .print-grid {
        grid-template-columns: 1fr;
    }
}
    </style>
</head>
<body>
    <div class="app-container" id="formContainer">
        <div class="app-header">
            <h1>‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß Stroke FAST TRACK</h1>
            <p>Mechanical Thrombectomy Referral Form</p>
        </div>

        <!-- Section 1: Basic Information -->
        <div class="section">
            <div class="section-header" onclick="toggleSection('section1')">
                <span class="section-title">üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ô‡πÑ‡∏Ç‡πâ</span>
                <span class="section-icon" id="icon-section1">‚ñº</span>
            </div>
            <div class="section-content expanded" id="section1">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">HN / Patient ID</label>
                        <input type="text" class="form-input" id="hn" placeholder="‡πÄ‡∏•‡∏Ç‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢">
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</label>
                        <input type="text" class="form-input" id="fullname" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏õ‡∏µ)</label>
                        <input type="number" class="form-input" id="age" placeholder="‡∏≠‡∏≤‡∏¢‡∏∏" min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (kg)</label>
                        <input type="number" class="form-input" id="weight" placeholder="‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å" min="0" step="0.1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡πÄ‡∏û‡∏®</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" id="male" name="gender" value="‡∏ä‡∏≤‡∏¢">
                                <label for="male">‡∏ä‡∏≤‡∏¢</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" id="female" name="gender" value="‡∏´‡∏ç‡∏¥‡∏á">
                                <label for="female">‡∏´‡∏ç‡∏¥‡∏á</label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 2: Initial History -->
        <div class="section">
            <div class="section-header" onclick="toggleSection('section2')">
                <span class="section-title">üïê ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</span>
                <span class="section-icon" id="icon-section2">‚ñº</span>
            </div>
            <div class="section-content expanded" id="section2">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£ (Onset Time)</label>
                        <input type="datetime-local" class="form-input" id="onsetTime">
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö</label>
                        <select class="form-select" id="location">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà --</option>
                            <option value="‡∏ö‡πâ‡∏≤‡∏ô">‡∏ö‡πâ‡∏≤‡∏ô</option>
                            <option value="‡∏ö‡∏ô‡∏ñ‡∏ô‡∏ô">‡∏ö‡∏ô‡∏ñ‡∏ô‡∏ô</option>
                            <option value="‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</option>
                            <option value="‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏≠‡∏∑‡πà‡∏ô</option>
                            <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß</label>
                    <label class="form-label">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä ‡∏ô‡∏Ñ‡∏£‡∏£‡∏≤‡∏ä‡∏™‡∏µ‡∏°‡∏≤</label>
                </div>
            </div>
        </div>

        <!-- Section 3: Medical History -->
        <div class="section">
            <div class="section-header" onclick="toggleSection('section3')">
                <span class="section-title">üìù ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</span>
                <span class="section-icon" id="icon-section3">‚ñº</span>
            </div>
            <div class="section-content expanded" id="section3">
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="dm" value="‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô">
                        <label for="dm">‡πÄ‡∏ö‡∏≤‡∏´‡∏ß‡∏≤‡∏ô (DM)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="ht" value="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á">
                        <label for="ht">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á (HT)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="dlp" value="‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏™‡∏π‡∏á">
                        <label for="dlp">‡πÑ‡∏Ç‡∏°‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î‡∏™‡∏π‡∏á (DLP)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="af" value="Atrial Fibrillation">
                        <label for="af">Atrial Fibrillation</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="cad" value="‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à">
                        <label for="cad">‡πÇ‡∏£‡∏Ñ‡∏´‡∏±‡∏ß‡πÉ‡∏à (CAD)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="ckd" value="‡πÇ‡∏£‡∏Ñ‡πÑ‡∏ï">
                        <label for="ckd">‡πÇ‡∏£‡∏Ñ‡πÑ‡∏ï (CKD)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="prevStroke" value="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ Stroke">
                        <label for="prevStroke">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥ Stroke</label>
                    </div>
                </div>
                <div class="form-group" style="margin-top: 16px;">
                    <label class="form-label">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                    <input type="text" class="form-input" id="otherHistory" placeholder="‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏≠‡∏∑‡πà‡∏ô‡πÜ">
                </div>
            </div>
        </div>

        <!-- Section 4: Current Status -->
        <div class="section">
            <div class="section-header" onclick="toggleSection('section4')">
                <span class="section-title">ü©∫ ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</span>
                <span class="section-icon" id="icon-section4">‚ñº</span>
            </div>
            <div class="section-content expanded" id="section4">
                <h4 style="margin-bottom: 12px; font-weight: 600;">Vital Signs</h4>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">SBP (mmHg)</label>
                        <input type="number" class="form-input" id="sbp" placeholder="120" min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">DBP (mmHg)</label>
                        <input type="number" class="form-input" id="dbp" placeholder="80" min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Heart Rate (bpm)</label>
                        <input type="number" class="form-input" id="hr" placeholder="72" min="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Respiratory Rate (/min)</label>
                        <input type="number" class="form-input" id="rr" placeholder="18" min="0">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Temperature (¬∞C)</label>
                        <input type="number" class="form-input" id="temp" placeholder="37" min="0" step="0.1">
                    </div>
                    <div class="form-group">
                        <label class="form-label">O2 Saturation (%)</label>
                        <input type="number" class="form-input" id="o2sat" placeholder="98" min="0" max="100">
                    </div>
                </div>
                
                <div class="form-row" style="margin-top: 20px;">
                    <div class="form-group">
                        <label class="form-label">GCS</label>
                        <select class="form-select" id="gcs">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å GCS --</option>
                            <option value="15">15</option>
                            <option value="14">14</option>
                            <option value="13">13</option>
                            <option value="12">12</option>
                            <option value="11">11</option>
                            <option value="10">10</option>
                            <option value="9">9</option>
                            <option value="8">8</option>
                            <option value="7">7</option>
                            <option value="6">6</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">NIHSS Score</label>
                        <input type="number" class="form-input" id="nihss" placeholder="NIHSS" min="0" max="42">
                    </div>
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label class="form-label">‡∏ó‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏à (Intubation)</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="intubNo" name="intubation" value="‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà">
                            <label for="intubNo">‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="intubYes" name="intubation" value="‡πÉ‡∏™‡πà">
                            <label for="intubYes">‡πÉ‡∏™‡πà‡∏ó‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏à</label>
                        </div>
                    </div>
                </div>

                <div class="form-group" style="margin-top: 20px;">
                    <label class="form-label">‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö rtPA</label>
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="rtpaNo" name="rtpa" value="‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ" onchange="toggleRtpaCalculation()">
                            <label for="rtpaNo">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="rtpaYes" name="rtpa" value="‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö" onchange="toggleRtpaCalculation()">
                            <label for="rtpaYes">‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö rtPA</label>
                        </div>
                    </div>
                </div>

                <div id="rtpaCalculationSection" style="display: none;">
                    <div class="form-group" style="margin-top: 16px;">
                        <label class="form-label">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ rtPA</label>
                        <input type="datetime-local" class="form-input" id="rtpaTime">
                    </div>
                    <button class="btn btn-secondary" onclick="calculateRtpa()" style="margin-top: 12px;">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì rtPA Dose</button>
                    <div id="rtpaResult" class="rtpa-calculation" style="display: none;"></div>
                </div>
            </div>
        </div>

        <!-- Section 5: Imaging Results -->
        <div class="section">
            <div class="section-header" onclick="toggleSection('section5')">
                <span class="section-title">üî¨ ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏≤‡∏á‡∏£‡∏±‡∏á‡∏™‡∏µ</span>
                <span class="section-icon" id="icon-section5">‚ñº</span>
            </div>
            <div class="section-content expanded" id="section5">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</label>
                        <select class="form-select" id="imagingType">
                            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó --</option>
                            <option value="CT Brain">CT Brain</option>
                            <option value="CTA Brain & Neck">CTA Brain &amp; Neck</option>
                            <option value="MRI">MRI</option>
                            <option value="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥</option>
                            <option value="‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏≥</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à</label>
                        <input type="datetime-local" class="form-input" id="imagingTime">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
                    <textarea class="form-textarea" id="imagingResult" placeholder="‡πÄ‡∏ä‡πà‡∏ô Acute infarct left MCA territory, Large vessel occlusion"></textarea>
                </div>
            </div>
        </div>

        <!-- Section 6: Referral Reason -->
        <div class="section">
            <div class="section-header" onclick="toggleSection('section6')">
                <span class="section-title">‚úÖ ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠</span>
                <span class="section-icon" id="icon-section6">‚ñº</span>
            </div>
            <div class="section-content expanded" id="section6">
                <div class="checkbox-group">
                    <div class="checkbox-item">
                        <input type="checkbox" id="lvo" value="Large vessel occlusion">
                        <label for="lvo">Large vessel occlusion</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="timeWindow" value="Within intervention window">
                        <label for="timeWindow">Within intervention window (6-24 hrs)</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="nihssHigh" value="NIHSS score ‚â• 6">
                        <label for="nihssHigh">NIHSS score ‚â• 6</label>
                    </div>
                    <div class="checkbox-item">
                        <input type="checkbox" id="goodCollateral" value="Good collateral circulation">
                        <label for="goodCollateral">Good collateral circulation</label>
                    </div>
                </div>
                <div class="form-group" style="margin-top: 16px;">
                    <label class="form-label">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</label>
                    <textarea class="form-textarea" id="otherReason" placeholder="‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠"></textarea>
                </div>
            </div>
        </div>

        <!-- Section 7: Additional Notes -->
        <div class="section">
            <div class="section-header" onclick="toggleSection('section7')">
                <span class="section-title">üìå ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</span>
                <span class="section-icon" id="icon-section7">‚ñº</span>
            </div>
            <div class="section-content expanded" id="section7">
                <div class="form-group">
                    <label class="form-label">Contraindications / Special Considerations</label>
                    <textarea class="form-textarea" id="contraindications" placeholder="‡∏Ç‡πâ‡∏≠‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏£‡∏∞‡∏ß‡∏±‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏©"></textarea>
                </div>
                <div class="form-row" style="margin-top: 16px;">
                    <div class="form-group">
                        <label class="form-label">‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á</label>
                        <input type="text" class="form-input" id="referringDoctor" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á">
                    </div>
                    <div class="form-group">
                        <label class="form-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label>
                        <input type="tel" class="form-input" id="doctorPhone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
                    </div>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn btn-primary" onclick="generatePrint()">üìÑ Generate &amp; Print</button>
            <button class="btn btn-secondary" onclick="clearForm()">üîÑ Clear Form</button>
        </div>
    </div>

    <!-- Print Preview -->
    <div class="print-preview" id="printPreview">
        <div class="print-header">
            <h1>‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢ STROKE FAST TRACK</h1>
            <div class="subtitle">Mechanical Thrombectomy Referral Form</div>
            <div style="margin-top: 10px; font-size: 14px;" id="printDate"></div>
        </div>

        <div id="printContent"></div>

        <div class="print-signature-area">
            <div class="signature-box">
                <div class="signature-line">
                    <div>‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á (Referring Doctor)</div>
                    <div id="printReferringDoctor" style="margin-top: 5px;"></div>
                </div>
            </div>
        </div>

        <div class="print-footer">
            <div>‡πÉ‡∏ö‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß‡∏à‡∏≤‡∏Å <span id="printHospital"></span> ‚Üí Maharat Nakhonratchasima Hospital</div>
        </div>

        <div class="action-buttons" style="margin-top: 30px;">
            <button class="btn btn-primary" onclick="window.print()">üñ®Ô∏è Print</button>
            <button class="btn btn-secondary" onclick="backToEdit()">‚Üê Back to Edit</button>
        </div>
    </div>

    <script>
        // Toggle section expand/collapse
        function toggleSection(sectionId) {
            const content = document.getElementById(sectionId);
            const icon = document.getElementById('icon-' + sectionId);
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.add('collapsed');
            } else {
                content.classList.add('expanded');
                icon.classList.remove('collapsed');
            }
        }

        // Toggle rtPA calculation section
        function toggleRtpaCalculation() {
            const rtpaYes = document.getElementById('rtpaYes').checked;
            const rtpaSection = document.getElementById('rtpaCalculationSection');
            
            if (rtpaYes) {
                rtpaSection.style.display = 'block';
            } else {
                rtpaSection.style.display = 'none';
                document.getElementById('rtpaResult').style.display = 'none';
            }
        }

        // Calculate rtPA doses
        function calculateRtpa() {
            const weight = parseFloat(document.getElementById('weight').value);
            
            if (!weight || weight <= 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            // Standard dose: 0.9 mg/kg (max 90 mg)
            const standardDose = Math.min(weight * 0.9, 90);
            const standardBolus = standardDose * 0.1;
            const standardInfusion = standardDose * 0.9;

            // Alternative dose: 0.6 mg/kg
            const altDose = weight * 0.6;
            const altBolus = altDose * 0.1;
            const altInfusion = altDose * 0.9;

            const resultDiv = document.getElementById('rtpaResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h4>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì rtPA Dose (‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å ${weight} kg)</h4>
                <div style="margin-top: 12px;">
                    <strong>Standard Dose (0.9 mg/kg):</strong>
                    <div class="rtpa-dose-item">
                        <span>Total dose:</span>
                        <span><strong>${standardDose.toFixed(2)} mg</strong></span>
                    </div>
                    <div class="rtpa-dose-item">
                        <span>Bolus (10% over 1 min):</span>
                        <span><strong>${standardBolus.toFixed(2)} mg</strong></span>
                    </div>
                    <div class="rtpa-dose-item">
                        <span>Infusion (90% over 60 min):</span>
                        <span><strong>${standardInfusion.toFixed(2)} mg</strong></span>
                    </div>
                </div>
                <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid var(--color-card-border);">
                    <strong>Alternative Dose (0.6 mg/kg):</strong>
                    <div class="rtpa-dose-item">
                        <span>Total dose:</span>
                        <span><strong>${altDose.toFixed(2)} mg</strong></span>
                    </div>
                    <div class="rtpa-dose-item">
                        <span>Bolus (10% over 1 min):</span>
                        <span><strong>${altBolus.toFixed(2)} mg</strong></span>
                    </div>
                    <div class="rtpa-dose-item">
                        <span>Infusion (90% over 60 min):</span>
                        <span><strong>${altInfusion.toFixed(2)} mg</strong></span>
                    </div>
                </div>
            `;
        }

        // Collect form data
        function collectFormData() {
            const gender = document.querySelector('input[name="gender"]:checked');
            const intubation = document.querySelector('input[name="intubation"]:checked');
            const rtpa = document.querySelector('input[name="rtpa"]:checked');
            
            // Medical history checkboxes
            const medicalHistory = [];
            const historyCheckboxes = ['dm', 'ht', 'dlp', 'af', 'cad', 'ckd', 'prevStroke'];
            historyCheckboxes.forEach(id => {
                if (document.getElementById(id).checked) {
                    medicalHistory.push(document.querySelector(`label[for="${id}"]`).textContent);
                }
            });
            const otherHistory = document.getElementById('otherHistory').value;
            if (otherHistory) {
                medicalHistory.push(otherHistory);
            }

            // Referral reasons
            const referralReasons = [];
            const reasonCheckboxes = ['lvo', 'timeWindow', 'nihssHigh', 'goodCollateral'];
            reasonCheckboxes.forEach(id => {
                if (document.getElementById(id).checked) {
                    referralReasons.push(document.querySelector(`label[for="${id}"]`).textContent);
                }
            });

            return {
                hn: document.getElementById('hn').value,
                fullname: document.getElementById('fullname').value,
                age: document.getElementById('age').value,
                weight: document.getElementById('weight').value,
                gender: gender ? gender.value : '',
                onsetTime: document.getElementById('onsetTime').value,
                location: document.getElementById('location').value,
                referringHospital: document.getElementById('referringHospital').value,
                medicalHistory: medicalHistory,
                sbp: document.getElementById('sbp').value,
                dbp: document.getElementById('dbp').value,
                hr: document.getElementById('hr').value,
                rr: document.getElementById('rr').value,
                temp: document.getElementById('temp').value,
                o2sat: document.getElementById('o2sat').value,
                gcs: document.getElementById('gcs').value,
                nihss: document.getElementById('nihss').value,
                intubation: intubation ? intubation.value : '',
                rtpa: rtpa ? rtpa.value : '',
                rtpaTime: document.getElementById('rtpaTime').value,
                imagingType: document.getElementById('imagingType').value,
                imagingTime: document.getElementById('imagingTime').value,
                imagingResult: document.getElementById('imagingResult').value,
                referralReasons: referralReasons,
                otherReason: document.getElementById('otherReason').value,
                contraindications: document.getElementById('contraindications').value,
                referringDoctor: document.getElementById('referringDoctor').value,
                doctorPhone: document.getElementById('doctorPhone').value
            };
        }

        // Format datetime for display
        function formatDateTime(datetimeStr) {
            if (!datetimeStr) return '-';
            const date = new Date(datetimeStr);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear() + 543; // Thai Buddhist year
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${day}/${month}/${year} ${hours}:${minutes} ‡∏ô.`;
        }

        // Generate print preview
        function generatePrint() {
            const data = collectFormData();
            const weight = parseFloat(data.weight);
            
            // Calculate rtPA if applicable
            let rtpaInfo = '';
            if (data.rtpa === '‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö' && weight > 0) {
                const standardDose = Math.min(weight * 0.9, 90);
                const standardBolus = standardDose * 0.1;
                const standardInfusion = standardDose * 0.9;
                const altDose = weight * 0.6;
                const altBolus = altDose * 0.1;
                const altInfusion = altDose * 0.9;
                
                rtpaInfo = `
                    <div class="print-section">
                        <div class="print-section-title">‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ rtPA</div>
                        <div class="print-item">
                            <span class="print-item-label">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ rtPA:</span>
                            <span class="print-item-value">${formatDateTime(data.rtpaTime)}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">Standard dose (0.9 mg/kg):</span>
                            <span class="print-item-value">${standardDose.toFixed(2)} mg (Bolus: ${standardBolus.toFixed(2)} mg, Infusion: ${standardInfusion.toFixed(2)} mg)</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">Alternative dose (0.6 mg/kg):</span>
                            <span class="print-item-value">${altDose.toFixed(2)} mg (Bolus: ${altBolus.toFixed(2)} mg, Infusion: ${altInfusion.toFixed(2)} mg)</span>
                        </div>
                    </div>
                `;
            }

            const printContent = `
                <div class="print-section">
                    <div class="print-section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢</div>
                    <div class="print-grid">
                        <div class="print-item">
                            <span class="print-item-label">HN:</span>
                            <span class="print-item-value">${data.hn || '-'}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•:</span>
                            <span class="print-item-value">${data.fullname || '-'}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡∏≠‡∏≤‡∏¢‡∏∏:</span>
                            <span class="print-item-value">${data.age || '-'} ‡∏õ‡∏µ</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡πÄ‡∏û‡∏®:</span>
                            <span class="print-item-value">${data.gender || '-'}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å:</span>
                            <span class="print-item-value">${data.weight || '-'} kg</span>
                        </div>
                    </div>
                </div>

                <div class="print-section">
                    <div class="print-section-title">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</div>
                    <div class="print-grid">
                        <div class="print-item">
                            <span class="print-item-label">‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:</span>
                            <span class="print-item-value">${formatDateTime(data.onsetTime)}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö:</span>
                            <span class="print-item-value">${data.location || '-'}</span>
                        </div>
                        <div class="print-item print-full-width">
                            <span class="print-item-label">‡πÇ‡∏£‡∏á‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡∏™‡πà‡∏á‡∏ï‡∏±‡∏ß:</span>
                            <span class="print-item-value">${data.referringHospital || '-'}</span>
                        </div>
                    </div>
                </div>

                <div class="print-section">
                    <div class="print-section-title">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå</div>
                    <div class="print-item print-full-width">
                        <span class="print-item-label">‡πÇ‡∏£‡∏Ñ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß:</span>
                        <span class="print-item-value">${data.medicalHistory.length > 0 ? data.medicalHistory.join(', ') : '‡πÑ‡∏°‡πà‡∏°‡∏µ'}</span>
                    </div>
                </div>

                <div class="print-section">
                    <div class="print-section-title">‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ä‡∏µ‡∏û (Vital Signs)</div>
                    <div class="print-grid">
                        <div class="print-item">
                            <span class="print-item-label">Blood Pressure:</span>
                            <span class="print-item-value">${data.sbp || '-'}/${data.dbp || '-'} mmHg</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">Heart Rate:</span>
                            <span class="print-item-value">${data.hr || '-'} bpm</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">Respiratory Rate:</span>
                            <span class="print-item-value">${data.rr || '-'} /min</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">Temperature:</span>
                            <span class="print-item-value">${data.temp || '-'} ¬∞C</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">O2 Saturation:</span>
                            <span class="print-item-value">${data.o2sat || '-'} %</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">GCS:</span>
                            <span class="print-item-value">${data.gcs || '-'}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">NIHSS Score:</span>
                            <span class="print-item-value">${data.nihss || '-'}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡∏ó‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏à:</span>
                            <span class="print-item-value">${data.intubation || '-'}</span>
                        </div>
                    </div>
                </div>

                ${data.rtpa === '‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö' ? rtpaInfo : `
                    <div class="print-section">
                        <div class="print-section-title">‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ rtPA</div>
                        <div class="print-item">
                            <span class="print-item-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</span>
                            <span class="print-item-value">‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö rtPA</span>
                        </div>
                    </div>
                `}

                <div class="print-section">
                    <div class="print-section-title">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏≤‡∏á‡∏£‡∏±‡∏á‡∏™‡∏µ</div>
                    <div class="print-grid">
                        <div class="print-item">
                            <span class="print-item-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</span>
                            <span class="print-item-value">${data.imagingType || '-'}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:</span>
                            <span class="print-item-value">${formatDateTime(data.imagingTime)}</span>
                        </div>
                        <div class="print-item print-full-width">
                            <span class="print-item-label">‡∏ú‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</span>
                            <span class="print-item-value">${data.imagingResult || '-'}</span>
                        </div>
                    </div>
                </div>

                <div class="print-section">
                    <div class="print-section-title">‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠</div>
                    <div class="print-item print-full-width">
                        <span class="print-item-label">‡πÄ‡∏Å‡∏ì‡∏ë‡πå:</span>
                        <span class="print-item-value">${data.referralReasons.length > 0 ? data.referralReasons.join(', ') : '-'}</span>
                    </div>
                    ${data.otherReason ? `
                        <div class="print-item print-full-width">
                            <span class="print-item-label">‡∏≠‡∏∑‡πà‡∏ô‡πÜ:</span>
                            <span class="print-item-value">${data.otherReason}</span>
                        </div>
                    ` : ''}
                </div>

                ${data.contraindications ? `
                    <div class="print-section">
                        <div class="print-section-title">Contraindications / Special Considerations</div>
                        <div class="print-item print-full-width">
                            <span class="print-item-value">${data.contraindications}</span>
                        </div>
                    </div>
                ` : ''}

                <div class="print-section">
                    <div class="print-section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</div>
                    <div class="print-grid">
                        <div class="print-item">
                            <span class="print-item-label">‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡∏™‡πà‡∏á:</span>
                            <span class="print-item-value">${data.referringDoctor || '-'}</span>
                        </div>
                        <div class="print-item">
                            <span class="print-item-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</span>
                            <span class="print-item-value">${data.doctorPhone || '-'}</span>
                        </div>
                    </div>
                </div>
            `;

            // Update print preview
            document.getElementById('printContent').innerHTML = printContent;
            
            // Update date and hospital
            const now = new Date();
            document.getElementById('printDate').textContent = formatDateTime(now.toISOString().slice(0, 16));
            document.getElementById('printHospital').textContent = data.referringHospital || '-';
            document.getElementById('printReferringDoctor').textContent = data.referringDoctor || '';

            // Show print preview, hide form
            document.getElementById('formContainer').style.display = 'none';
            document.getElementById('printPreview').classList.add('active');
        }

        // Back to edit
        function backToEdit() {
            document.getElementById('formContainer').style.display = 'block';
            document.getElementById('printPreview').classList.remove('active');
        }

        // Clear form
        function clearForm() {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                document.querySelectorAll('input, select, textarea').forEach(element => {
                    if (element.type === 'radio' || element.type === 'checkbox') {
                        element.checked = false;
                    } else {
                        element.value = '';
                    }
                });
                document.getElementById('rtpaCalculationSection').style.display = 'none';
                document.getElementById('rtpaResult').style.display = 'none';
            }
        }

        // Initialize: Expand all sections by default
        window.addEventListener('DOMContentLoaded', function() {
            // All sections are already expanded by default in HTML
        });
    </script>
</body>
</html>
